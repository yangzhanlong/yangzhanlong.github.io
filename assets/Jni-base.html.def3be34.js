import{_ as n}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as s,c as a,d as t}from"./app.6a6b0b18.js";const e={},p=t(`<h1 id="jni\u57FA\u7840" tabindex="-1"><a class="header-anchor" href="#jni\u57FA\u7840" aria-hidden="true">#</a> Jni\u57FA\u7840</h1><h3 id="jni\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#jni\u6982\u8FF0" aria-hidden="true">#</a> JNI\u6982\u8FF0</h3><ul><li>\u5B9A\u4E49\uFF1A<code>Java Native Interface</code> \uFF0C\u5373Java\u672C\u5730\u63A5\u53E3</li><li>\u4F5C\u7528\uFF1A\u4F7F\u5F97Java\u4E0E\u672C\u5730\u5176\u4ED6\u8BED\u8A00(c,c++)\u4EA4\u4E92</li><li>JNI\u662F\u5C5E\u4E8EJava\u7684\uFF0C\u4E0EAndroid\u6CA1\u6709\u5173\u7CFB</li><li>\u5B9E\u9645\u4E2D\u7684\u9A71\u52A8\u90FD\u662Fc,c\u5F00\u653E\u7684\uFF0C\u901A\u8FC7JNI.Java\u53EF\u4EE5\u8C03\u7528c/c\u5B9E\u73B0\u7684\u9A71\u52A8\uFF0C\u4ECE\u800C\u6269\u5C55java\u865A\u62DF\u673A\u7684\u80FD\u529B</li></ul><h3 id="\u4E3A\u4EC0\u4E48\u8981\u6709jni" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48\u8981\u6709jni" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48\u8981\u6709JNI</h3><ul><li>Java\u9700\u8981\u4E0E\u672C\u5730\u4EE3\u7801\u8FDB\u884C\u4EA4\u4E92\uFF0C\u56E0\u4E3Ajava\u5177\u5907\u8DE8\u5E73\u53F0\u7684\u7279\u70B9\uFF0C\u6240\u4EE5java\u4E0E\u672C\u5730\u4EE3\u7801\u4EA4\u4E92\u7684\u80FD\u529B\u975E\u5E38\u5F31\uFF0C\u91C7\u7528jni\u7279\u6548\u589E\u5F3Ajava\u4E0E\u672C\u5730\u4EE3\u7801\u4EA4\u4E92\u7684\u80FD\u529B</li></ul><h3 id="jni\u4E0Endk\u7684\u5173\u7CFB" tabindex="-1"><a class="header-anchor" href="#jni\u4E0Endk\u7684\u5173\u7CFB" aria-hidden="true">#</a> JNI\u4E0ENDK\u7684\u5173\u7CFB</h3><ul><li>jni\u5C5E\u4E8Ejava jvm\u865A\u62DF\u673A\u7684\u6280\u672F\uFF0Cndk\u662F\u5DE5\u5177\u96C6,\u662F\u5C5E\u4E8EAndroid\uFF0CNDK\u96C6\u6210\u4E86jni,c++,gcc \u7B49\u5404\u79CD\u5DE5\u5177</li></ul><h3 id="\u7B2C\u4E00\u4E2Andk\u9879\u76EE" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E00\u4E2Andk\u9879\u76EE" aria-hidden="true">#</a> \u7B2C\u4E00\u4E2ANDK\u9879\u76EE</h3><ol><li>\u9009\u62E9Native C++\u65B0\u5EFA\u9879\u76EE</li><li>\u521B\u5EFA\u5B8C\u6210\u540E\uFF0C\u4F1A\u5728main\u76EE\u5F55\u4E0B\u6709\u4E00\u4E2Acpp\u7684\u76EE\u5F55\uFF0C\u91CC\u9762\u5305\u542B<code>CMakeLists.txt</code>\u548C<code>native-lib.cpp</code></li></ol><h4 id="\u5934\u6587\u4EF6\u89E3\u91CA" tabindex="-1"><a class="header-anchor" href="#\u5934\u6587\u4EF6\u89E3\u91CA" aria-hidden="true">#</a> \u5934\u6587\u4EF6\u89E3\u91CA</h4><ol><li>\u4F7F\u7528<code>javah</code> \u547D\u4EE4\u751F\u6210\u5934\u6587\u4EF6</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>javah <span class="token parameter variable">-classpath</span> <span class="token builtin class-name">.</span> <span class="token parameter variable">-jni</span> <span class="token parameter variable">-d</span> /Users/yang/Study/Ndk/Jni/JniStudy/app/src/main/java com.multi.jnistudy.TestActivity
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>\u5F97\u5230\u7684\u5934\u6587\u4EF6 <code>com_multi_jnistudy_TestActivity.h</code></li></ol><div class="language-cpp ext-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;jni.h&gt;</span></span>

<span class="token comment">// \u89E3\u51B3\u5FAA\u73AF\u4F9D\u8D56\u7684\u95EE\u9898\uFF0C\u7B2C\u4E8C\u6B21\u8FDB\u4E0D\u6765</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_Included_com_multi_jnistudy_TestActivity </span><span class="token comment">// \u5982\u679C\u6CA1\u6709\u8FD9\u4E2A\u5B8F</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_Included_com_multi_jnistudy_TestActivity</span> <span class="token comment">// \u5C31\u5B9A\u4E49\u8FD9\u4E2A\u5B8F</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus </span><span class="token comment">// \u5982\u679C\u662Fc++\u73AF\u5883</span></span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token punctuation">{</span> <span class="token comment">// \u5168\u90E8\u91C7\u7528c\u7684\u65B9\u5F0F,\u4E0D\u5141\u8BB8\u4F60\u51FD\u6570\u91CD\u8F7D\uFF0C\u51FD\u6570\u540D\u4E00\u6837\u7684\u95EE\u9898</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">com_multi_jnistudy_TestActivity_A</span></span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">com_multi_jnistudy_TestActivity_A</span> <span class="token expression"><span class="token number">100L</span></span></span>
    <span class="token comment">/*
    * \u51FD\u6570\u7684\u58F0\u660E
    * Class:     com_multi_jnistudy_TestActivity
    * Method:    getStringPwd
    * Signature: ()Ljava/lang/String;
    */</span>
    JNIEXPORT jstring JNICALL <span class="token function">Java_com_multi_jnistudy_TestActivity_getStringPwd</span>
        <span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span><span class="token punctuation">,</span> jobject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">/*
    * Class:     com_multi_jnistudy_TestActivity
    * Method:    getStringPwd2
    * Signature: ()Ljava/lang/String;
    */</span>
    JNIEXPORT jstring JNICALL <span class="token function">Java_com_multi_jnistudy_TestActivity_getStringPwd2</span>
        <span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span><span class="token punctuation">,</span> jclass<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="cpp\u6587\u4EF6\u89E3\u91CA" tabindex="-1"><a class="header-anchor" href="#cpp\u6587\u4EF6\u89E3\u91CA" aria-hidden="true">#</a> cpp\u6587\u4EF6\u89E3\u91CA</h4><ol><li>extern &quot;C&quot;</li></ol><blockquote><p>extern &quot;C&quot;\uFF1A \u5FC5\u987B\u91C7\u7528C\u7684\u7F16\u8BD1\u65B9\u5F0F\uFF0C\u4E3A\u4EC0\u4E48\uFF0C\u8BF7\u770BJNIEnv\u5185\u90E8\u6E90\u7801 \u65E0\u8BBA\u662FC\u8FD8\u662FC++ \u6700\u7EC8\u662F\u8C03\u7528\u5230 C\u7684JNINativeInterface\uFF0C\u6240\u4EE5\u5FC5\u987B\u91C7\u7528C\u7684\u65B9\u5F0F extern &quot;C&quot; \u51FD\u6570\u7684\u5B9E\u73B0</p></blockquote><ol start="2"><li>JNIEXPORT</li></ol><blockquote><p>\u6807\u8BB0\u8BE5\u65B9\u6CD5\u53EF\u4EE5\u88AB\u5916\u90E8\u8C03\u7528\uFF08VS\u4E0A\u4E0D\u52A0\u5165 \u8FD0\u884C\u4F1A\u62A5\u9519\uFF0C AS\u4E0A\u4E0D\u52A0\u5165\u8FD0\u884C\u6CA1\u6709\u95EE\u9898\uFF09 Linux\u8FD0\u884C\u4E0D\u52A0\u5165\uFF0C\u4E0D\u62A5\u9519, Win \u4F60\u5FC5\u987B\u52A0\u5165 \u5426\u5219\u8FD0\u884C\u62A5\u9519, MacOS \u8FD8\u4E0D\u77E5\u9053</p></blockquote><ol start="3"><li>jstring</li></ol><blockquote><p>Java &lt;---&gt; native \u8F6C\u6362\u7528\u7684</p></blockquote><ol start="4"><li>JNICALL</li></ol><blockquote><p>\u4EE3\u8868\u662F JNI\u6807\u8BB0\uFF0C\u53EF\u4EE5\u5C11</p></blockquote><ol start="5"><li>Java_com_multi_jnistudy_MainActivity_getStringPwd</li></ol><blockquote><p>Java_\u5305\u540D_\u7C7B\u540D_\u65B9\u6CD5\u540D \u6CE8\u610F\uFF1A\u6211\u4EEC\u7684\u5305\u540D native_1</p></blockquote><ol start="6"><li>JNIEnv*</li></ol><blockquote><p>JNIEnv * env JNI\uFF1A\u7684\u6865\u6881\u73AF\u5883 300\u591A\u4E2A\u51FD\u6570\uFF0C\u6240\u4EE5\u7684JNI\u64CD\u4F5C\uFF0C\u5FC5\u987B\u9760\u4ED6</p></blockquote><ol start="7"><li>jobject</li></ol><blockquote><p>jobject jobj \u8C01\u8C03\u7528\uFF0C\u5C31\u662F\u8C01\u7684\u5B9E\u4F8B MainActivity this</p></blockquote><ol start="8"><li>jclass</li></ol><blockquote><p>jclass clazz \u8C01\u8C03\u7528\uFF0C\u5C31\u662F\u8C01\u7684class MainActivity.class \u9759\u6001\u65B9\u6CD5</p></blockquote><div class="language-cpp ext-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;jni.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

<span class="token comment">// NDK\u5DE5\u5177\u94FE\u91CC\u9762\u7684 log \u5E93 \u5F15\u5165\u8FC7\u6765</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;android/log.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TAG</span> <span class="token string">&quot;Yang&quot;</span></span>
<span class="token comment">// ... \u6211\u90FD\u4E0D\u77E5\u9053\u4F20\u5165\u4EC0\u4E48  \u501F\u52A9JNI\u91CC\u9762\u7684\u5B8F\u6765\u81EA\u52A8\u5E2E\u6211\u586B\u5145</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">LOGD</span><span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token function">__android_log_print</span><span class="token punctuation">(</span>ANDROID_LOG_DEBUG<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span> __VA_ARGS__<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">LOGE</span><span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token function">__android_log_print</span><span class="token punctuation">(</span>ANDROID_LOG_ERROR<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span> __VA_ARGS__<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">LOGI</span><span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token function">__android_log_print</span><span class="token punctuation">(</span>ANDROID_LOG_INFO<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span> __VA_ARGS__<span class="token punctuation">)</span></span></span>

<span class="token comment">// extern &quot;C&quot;\uFF1A \u5FC5\u987B\u91C7\u7528C\u7684\u7F16\u8BD1\u65B9\u5F0F\uFF0C\u4E3A\u4EC0\u4E48\uFF0C\u8BF7\u770BJNIEnv\u5185\u90E8\u6E90\u7801</span>
<span class="token comment">// \u65E0\u8BBA\u662FC\u8FD8\u662FC++ \u6700\u7EC8\u662F\u8C03\u7528\u5230 C\u7684JNINativeInterface\uFF0C\u6240\u4EE5\u5FC5\u987B\u91C7\u7528C\u7684\u65B9\u5F0F extern &quot;C&quot;</span>
<span class="token comment">// \u51FD\u6570\u7684\u5B9E\u73B0</span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span>

<span class="token comment">//\u6807\u8BB0\u8BE5\u65B9\u6CD5\u53EF\u4EE5\u88AB\u5916\u90E8\u8C03\u7528\uFF08VS\u4E0A\u4E0D\u52A0\u5165 \u8FD0\u884C\u4F1A\u62A5\u9519\uFF0C AS\u4E0A\u4E0D\u52A0\u5165\u8FD0\u884C\u6CA1\u6709\u95EE\u9898\uFF09</span>
<span class="token comment">//Linux\u8FD0\u884C\u4E0D\u52A0\u5165\uFF0C\u4E0D\u62A5\u9519,  Win \u4F60\u5FC5\u987B\u52A0\u5165 \u5426\u5219\u8FD0\u884C\u62A5\u9519,   MacOS \u8FD8\u4E0D\u77E5\u9053</span>
JNIEXPORT

<span class="token comment">// Java &lt;---&gt; native \u8F6C\u6362\u7528\u7684</span>
jstring

<span class="token comment">// \u4EE3\u8868\u662F JNI\u6807\u8BB0\uFF0C\u53EF\u4EE5\u5C11</span>
JNICALL

<span class="token comment">// Java_\u5305\u540D_\u7C7B\u540D_\u65B9\u6CD5\u540D  \uFF0C\u6CE8\u610F\uFF1A\u6211\u4EEC\u7684\u5305\u540D _     native _1</span>

<span class="token comment">// JNIEnv * env  JNI\uFF1A\u7684\u6865\u6881\u73AF\u5883    300\u591A\u4E2A\u51FD\u6570\uFF0C\u6240\u4EE5\u7684JNI\u64CD\u4F5C\uFF0C\u5FC5\u987B\u9760\u4ED6</span>

<span class="token comment">// jobject jobj  \u8C01\u8C03\u7528\uFF0C\u5C31\u662F\u8C01\u7684\u5B9E\u4F8B  MainActivity this</span>
<span class="token comment">// jclass clazz \u8C01\u8C03\u7528\uFF0C\u5C31\u662F\u8C01\u7684class MainActivity.class \u9759\u6001\u65B9\u6CD5</span>
<span class="token function">Java_com_multi_jnistudy_MainActivity_getStringPwd</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jobject thiz<span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span>
JNIEXPORT jstring JNICALL
<span class="token function">Java_com_multi_jnistudy_MainActivity_getStringPwd2</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jobject thiz<span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span>
JNIEXPORT jstring JNICALL
<span class="token function">Java_com_multi_jnistudy_MainActivity_getMyName</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jclass clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
    *  class _jarray : public _jobject {};
       class _jobjectArray : public _jarray {};
       typedef _jobjectArray*  jobjectArray;
       typedef _jarray*        jarray;

       jobjectArray \u7EE7\u627F jarray
    */</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token comment">// \u751F\u6210\u5934\u6587\u4EF6\uFF1Ajavah com.multi.jnistudy.MainActivity</span>
<span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">lateinit</span> <span class="token keyword">var</span> binding<span class="token operator">:</span> ActivityMainBinding
    <span class="token keyword">val</span> A <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;Yang&quot;</span></span> <span class="token comment">// \u7B7E\u540D\uFF1ALjava/lang/String;</span>
    <span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">29</span> <span class="token comment">// \u7B7E\u540D\uFF1AI</span>


    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>

        binding <span class="token operator">=</span> ActivityMainBinding<span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span>layoutInflater<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>binding<span class="token punctuation">.</span>root<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Java \u672C\u5730\u65B9\u6CD5  \u5B9E\u73B0\uFF1Anative\u5C42</span>
    <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">getStringPwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> String
    <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">getStringPwd2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> String


    <span class="token keyword">companion</span> <span class="token keyword">object</span> <span class="token punctuation">{</span>
        <span class="token comment">// Used to load the &#39;jnistudy&#39; library on application startup.</span>
        <span class="token keyword">init</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;jnistudy&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token annotation builtin">@JvmStatic</span>
        <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">getMyName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>String <span class="token comment">// \u9759\u6001\u65B9\u6CD5</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7B7E\u540D\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#\u7B7E\u540D\u89C4\u5219" aria-hidden="true">#</a> \u7B7E\u540D\u89C4\u5219</h3><ul><li>javap -s -p MainActivity \u5FC5\u987B\u662F.class</li><li>javap -s -p xxx.class -s \u8F93\u51FAxxxx.class\u7684\u6240\u6709\u5C5E\u6027\u548C\u65B9\u6CD5\u7684\u7B7E\u540D\uFF0C -p \u5FFD\u7565\u79C1\u6709\u516C\u5F00\u7684\u6240\u6709\u5C5E\u6027\u65B9\u6CD5\u5168\u90E8\u8F93\u51FA</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Java\u7684boolean  --- Z  \u6CE8\u610F\u70B9
Java\u7684byte  --- B
Java\u7684char  --- C
Java\u7684short  --- S
Java\u7684int  --- I
Java\u7684long  --- J     \u6CE8\u610F\u70B9
Java\u7684float  --- F
Java\u7684double  --- D
Java\u7684void  --- V
Java\u7684\u5F15\u7528\u7C7B\u578B  --- Lxxx/xxx/xx/\u7C7B\u540D;
Java\u7684String  --- Ljava/lang/String;
Java\u7684array  int[]  --- [I         double[][][][]  --- [[[D
int add(char c1, char c2) ---- (CC)I
void a()     ===  ()V
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="jni\u7B80\u5355\u4F8B\u5B50" tabindex="-1"><a class="header-anchor" href="#jni\u7B80\u5355\u4F8B\u5B50" aria-hidden="true">#</a> JNI\u7B80\u5355\u4F8B\u5B50</h3><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">lateinit</span> <span class="token keyword">var</span> binding<span class="token operator">:</span> ActivityMainBinding
    <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;Yang&quot;</span></span> <span class="token comment">// \u7B7E\u540D\uFF1ALjava/lang/String;</span>
    <span class="token comment">//var age = 29 // \u7B7E\u540D\uFF1AI</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>

        binding <span class="token operator">=</span> ActivityMainBinding<span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span>layoutInflater<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>binding<span class="token punctuation">.</span>root<span class="token punctuation">)</span>
        <span class="token function">changeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        Log<span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Yang&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;\u4FEE\u6539\u540E\u7684name:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">name</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token function">changeAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        Log<span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Yang&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;\u4FEE\u6539\u540E\u7684age:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">age</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token function">callAddMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">changeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">callAddMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// \u4E13\u95E8\u5199\u4E00\u4E2A\u51FD\u6570\uFF0C\u7ED9native\u6210\u8C03\u7528</span>
    <span class="token keyword">fun</span> <span class="token function">add</span><span class="token punctuation">(</span>number1<span class="token operator">:</span> Int<span class="token punctuation">,</span> number2<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> Int <span class="token punctuation">{</span>
        <span class="token keyword">return</span> number1 <span class="token operator">+</span> number2 <span class="token operator">+</span> <span class="token number">8</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">companion</span> <span class="token keyword">object</span> <span class="token punctuation">{</span>
        <span class="token comment">// System.load(); \u8FD9\u79CD\u662F\u53EF\u4EE5\u7EDD\u5BF9\u8DEF\u5F84\u7684\u52A0\u8F7D\u52A8\u6001\u94FE\u63A5\u5E93\u6587\u4EF6</span>
        <span class="token comment">// System.loadLibrary \u8FD9\u79CD\u662F\u4ECE\u5E93\u76EE\u5F55\u904D\u5386\u5C42\u7EA7\u76EE\u5F55\uFF0C\u53BB\u81EA\u52A8\u7684\u5BFB\u627E</span>
        <span class="token keyword">init</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;jnistudy&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token annotation builtin">@JvmStatic</span>
        <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">changeAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> age <span class="token operator">=</span> <span class="token number">29</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-cpp ext-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span>
JNIEXPORT <span class="token keyword">void</span> JNICALL
<span class="token function">Java_com_multi_jnistudy_MainActivity_changeName</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jobject thiz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u83B7\u53D6class</span>
    jclass j_cls <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetObjectClass</span><span class="token punctuation">(</span>thiz<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// \u83B7\u53D6\u5C5E\u6027 L\u5BF9\u8C61\u7C7B\u578B \u90FD\u9700\u8981L</span>
    <span class="token comment">// jfieldID GetFieldID(MainActivity.class, \u5C5E\u6027\u540D, \u5C5E\u6027\u7684\u7B7E\u540D)</span>
    jfieldID j_fid <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetFieldID</span><span class="token punctuation">(</span>j_cls<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Ljava/lang/String;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u4ECEclass\u83B7\u53D6jfieldID\u7684\u5C5E\u6027\u503C static_cast:\u5F3A\u8F6C</span>
    jstring j_str <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>jstring<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>env<span class="token operator">-&gt;</span><span class="token function">GetObjectField</span><span class="token punctuation">(</span>thiz<span class="token punctuation">,</span> j_fid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// jni\u5B57\u7B26\u4E32\u8F6C\u6210c++\u5B57\u7B26\u4E32</span>
    <span class="token keyword">char</span> <span class="token operator">*</span> c_str <span class="token operator">=</span> <span class="token generic-function"><span class="token function">const_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>env<span class="token operator">-&gt;</span><span class="token function">GetStringUTFChars</span><span class="token punctuation">(</span>j_str<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">LOGD</span><span class="token punctuation">(</span><span class="token string">&quot;native: %s\\n&quot;</span><span class="token punctuation">,</span> c_str<span class="token punctuation">)</span><span class="token punctuation">;</span>

    jstring name <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">NewStringUTF</span><span class="token punctuation">(</span><span class="token string">&quot;Yangmi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//void SetObjectField(jobject obj, jfieldID fieldID, jobject value)</span>
    env<span class="token operator">-&gt;</span><span class="token function">SetObjectField</span><span class="token punctuation">(</span>thiz<span class="token punctuation">,</span> j_fid<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span>
JNIEXPORT <span class="token keyword">void</span> JNICALL
<span class="token function">Java_com_multi_jnistudy_MainActivity_changeAge</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jclass clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u4FEE\u6539\u9759\u6001\u503C</span>

    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> sig <span class="token operator">=</span> <span class="token string">&quot;I&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//  jfieldID GetStaticFieldID(jclass clazz, const char* name, const char* sig)</span>
    jfieldID  j_fid <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetStaticFieldID</span><span class="token punctuation">(</span>clazz<span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> sig<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// jint GetStaticIntField(jclass clazz, jfieldID fieldID)</span>
    jint age <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetStaticIntField</span><span class="token punctuation">(</span>clazz<span class="token punctuation">,</span> j_fid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">LOGD</span><span class="token punctuation">(</span><span class="token string">&quot;native: %d\\n&quot;</span><span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    age<span class="token operator">+=</span><span class="token number">10</span><span class="token punctuation">;</span>
    env<span class="token operator">-&gt;</span><span class="token function">SetStaticIntField</span><span class="token punctuation">(</span>clazz<span class="token punctuation">,</span> j_fid<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span>
JNIEXPORT <span class="token keyword">void</span> JNICALL
<span class="token function">Java_com_multi_jnistudy_MainActivity_callAddMethod</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jobject thiz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u81EA\u5DF1\u5F97\u5230 MainActivity.class</span>
    jclass  mainActivityClass <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetObjectClass</span><span class="token punctuation">(</span>thiz<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// GetMethodID(MainActivity.class, \u65B9\u6CD5\u540D, \u65B9\u6CD5\u7684\u7B7E\u540D)</span>
    jmethodID j_mid <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetMethodID</span><span class="token punctuation">(</span>mainActivityClass<span class="token punctuation">,</span> <span class="token string">&quot;add&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(II)I&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// \u8C03\u7528 Java\u7684\u65B9\u6CD5</span>
    jint sum <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">CallIntMethod</span><span class="token punctuation">(</span>thiz<span class="token punctuation">,</span> j_mid<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">LOGE</span><span class="token punctuation">(</span><span class="token string">&quot;sum result:%d&quot;</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="jni\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#jni\u64CD\u4F5C" aria-hidden="true">#</a> JNI\u64CD\u4F5C</h3><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

     <span class="token keyword">private</span> <span class="token keyword">val</span> TAG <span class="token operator">=</span> MainActivity<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">.</span>simpleName

    static <span class="token punctuation">{</span>
        <span class="token comment">// System.load(); \u8FD9\u79CD\u662F\u53EF\u4EE5\u7EDD\u5BF9\u8DEF\u5F84\u7684\u52A0\u8F7D\u52A8\u6001\u94FE\u63A5\u5E93\u6587\u4EF6</span>
        System<span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;native-lib&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u8FD9\u79CD\u662F\u4ECE\u5E93\u76EE\u5F55\u904D\u5386\u5C42\u7EA7\u76EE\u5F55\uFF0C\u53BB\u81EA\u52A8\u7684\u5BFB\u627E</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        binding <span class="token operator">=</span> ActivityMainBinding<span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span>layoutInflater<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>binding<span class="token punctuation">.</span>root<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * \u4E0B\u9762\u662F native \u533A\u57DF
     */</span>

    <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">testArrayAction</span><span class="token punctuation">(</span>
        count<span class="token operator">:</span> Int<span class="token punctuation">,</span>
        textInfo<span class="token operator">:</span> String<span class="token punctuation">,</span>
        ints<span class="token operator">:</span> IntArray<span class="token punctuation">,</span>
        strs<span class="token operator">:</span> Array<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span> <span class="token comment">// String\u5F15\u7528\u7C7B\u578B\uFF0C\u73A9\u6570\u7EC4</span>


    <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">putObject</span><span class="token punctuation">(</span>student<span class="token operator">:</span> Student<span class="token punctuation">,</span> str<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token comment">// \u4F20\u9012\u5F15\u7528\u7C7B\u578B\uFF0C\u4F20\u9012\u5BF9\u8C61</span>


    <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">insertObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// \u51ED\u7A7A\u521B\u5EFAJava\u5BF9\u8C61</span>


    <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">testQuote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// \u6D4B\u8BD5\u5F15\u7528</span>

    <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">delQuote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// \u91CA\u653E\u5168\u5C40\u5F15\u7528</span>

    <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">textExternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


    <span class="token comment">/**
     * \u4E0B\u9762\u662F \u70B9\u51FB\u4E8B\u4EF6\u533A\u57DF
     */</span>
     <span class="token comment">// \u70B9\u51FB\u4E8B\u4EF6\uFF1A\u64CD\u4F5CtestArrayAction\u51FD\u6570</span>
     <span class="token keyword">fun</span> <span class="token function">test01</span><span class="token punctuation">(</span>view<span class="token operator">:</span> View<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> ints <span class="token operator">=</span> <span class="token function">intArrayOf</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> strs <span class="token operator">=</span> <span class="token function">arrayOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;\u674E\u5C0F\u9F99&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;\u674E\u8FDE\u6770&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;\u674E\u5143\u9738&quot;</span></span><span class="token punctuation">)</span>
        <span class="token function">testArrayAction</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;\u4F60\u597D&quot;</span></span><span class="token punctuation">,</span> ints<span class="token punctuation">,</span> strs<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>anInt <span class="token keyword">in</span> ints<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;test01: anInt:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">anInt</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// \u70B9\u51FB\u4E8B\u4EF6\uFF1A\u64CD\u4F5CputObject\u51FD\u6570 </span>
    <span class="token keyword">fun</span> <span class="token function">test02</span><span class="token punctuation">(</span>view<span class="token operator">:</span> View<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> student <span class="token operator">=</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        student<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;\u53F2\u6CF0\u9F99&quot;</span></span>
        student<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">88</span>
        <span class="token function">putObject</span><span class="token punctuation">(</span>student<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;\u4E5D\u9633\u795E\u529F&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// \u70B9\u51FB\u4E8B\u4EF6\uFF1A\u64CD\u4F5CinsertObject\u51FD\u6570</span>
    <span class="token keyword">fun</span> <span class="token function">test03</span><span class="token punctuation">(</span>view<span class="token operator">:</span> View<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">insertObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// \u70B9\u51FB\u4E8B\u4EF6\uFF1A\u4E24\u4E2A\u51FD\u6570\u662F\u4E00\u8D77\u7684\uFF0C\u64CD\u4F5C\u5F15\u7528 \u4E0E \u91CA\u653E\u5F15\u7528</span>
    <span class="token keyword">fun</span> <span class="token function">test04</span><span class="token punctuation">(</span>view<span class="token operator">:</span> View<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">testQuote</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">fun</span> <span class="token function">test05</span><span class="token punctuation">(</span>view<span class="token operator">:</span> View<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">delQuote</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fun</span> <span class="token function">test06</span><span class="token punctuation">(</span>view<span class="token operator">:</span> View<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">textExternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6570\u7EC4\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#\u6570\u7EC4\u64CD\u4F5C" aria-hidden="true">#</a> \u6570\u7EC4\u64CD\u4F5C</h4><p><code>GetIntArrayElements</code> <code>GetArrayLength</code> <code>GetObjectArrayElement</code></p><div class="language-cpp ext-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">/**
 *  jint == int
    jstring == String
    jintArray == int[]
    jobjectArray == \u5F15\u7528\u7C7B\u578B\u5BF9\u8C61\uFF0C\u4F8B\u5982 String[]   Test[]   Student[]  Person[]
 */</span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span>
JNIEXPORT <span class="token keyword">void</span> JNICALL
<span class="token function">Java_com_multi_jnistudy_MainActivity_testArrayAction</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jobject thiz<span class="token punctuation">,</span> jint count<span class="token punctuation">,</span>
                                                     jstring text_info<span class="token punctuation">,</span> jintArray ints<span class="token punctuation">,</span>
                                                     jobjectArray strs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u2460 \u57FA\u672C\u6570\u636E\u7C7B\u578B  jint count\uFF0C jstring text_info\uFF0C \u6700\u7B80\u5355\u7684</span>
    <span class="token keyword">int</span> countInt <span class="token operator">=</span> count<span class="token punctuation">;</span>
    <span class="token function">LOGI</span><span class="token punctuation">(</span><span class="token string">&quot;\u53C2\u65701\uFF1A%d\\n&quot;</span><span class="token punctuation">,</span> countInt<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// const char* GetStringUTFChars(jstring string, jboolean* isCopy)</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> textInfo <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetStringUTFChars</span><span class="token punctuation">(</span>text_info<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">LOGI</span><span class="token punctuation">(</span><span class="token string">&quot;\u53C2\u6570\u4E8C textInfo:%s\\n&quot;</span><span class="token punctuation">,</span> textInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// \u2461 \u628Aint[] \u8F6C\u6210 int*</span>
    <span class="token comment">// jint* GetIntArrayElements(jintArray array, jboolean* isCopy)</span>
    <span class="token keyword">int</span><span class="token operator">*</span> jintArray <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetIntArrayElements</span><span class="token punctuation">(</span>ints<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Java\u5C42\u6570\u7EC4\u7684\u957F\u5EA6</span>
    <span class="token comment">// \u76EE\u524D\u65E0\u6CD5\u63A7\u5236Java\u7684\u6570\u7EC4 \u53D8\u5316 +100</span>
    <span class="token comment">// jsize GetArrayLength(jarray array) // jintArray ints \u53EF\u4EE5\u653E\u5165\u5230 jarray\u7684\u53C2\u6570\u4E2D\u53BB</span>
    jsize size <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetArrayLength</span><span class="token punctuation">(</span>ints<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>jintArray<span class="token operator">+</span>i<span class="token punctuation">)</span> <span class="token operator">+=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// C++\u7684\u4FEE\u6539\uFF0C\u5F71\u54CD\u4E0D\u4E86Java\u5C42</span>
        <span class="token function">LOGI</span><span class="token punctuation">(</span><span class="token string">&quot;\u53C2\u6570\u4E09 int[]:%d\\n&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>jintArray<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 0:           \u5237\u65B0Java\u6570\u7EC4\uFF0C\u5E76 \u91CA\u653EC++\u5C42\u6570\u7EC4
     * JNI_COMMIT:  \u53EA\u63D0\u4EA4 \u53EA\u5237\u65B0Java\u6570\u7EC4\uFF0C\u4E0D\u91CA\u653EC++\u5C42\u6570\u7EC4
     * JNI_ABORT:   \u53EA\u91CA\u653EC++\u5C42\u6570\u7EC4
     */</span>
    env<span class="token operator">-&gt;</span><span class="token function">ReleaseIntArrayElements</span><span class="token punctuation">(</span>ints<span class="token punctuation">,</span> jintArray<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// \u2462\uFF1AjobjectArray \u4EE3\u8868\u662FJava\u7684\u5F15\u7528\u7C7B\u578B\u6570\u7EC4\uFF0C\u4E0D\u4E00\u6837</span>
    jsize  strssize <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetArrayLength</span><span class="token punctuation">(</span>strs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> strssize<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        jstring jobj <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>jstring<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>env<span class="token operator">-&gt;</span><span class="token function">GetObjectArrayElement</span><span class="token punctuation">(</span>strs<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u6A21\u7CCA\uFF1AisCopy\u5185\u90E8\u542F\u52A8\u7684\u673A\u5236</span>
        <span class="token comment">// const char* GetStringUTFChars(jstring string, jboolean* isCopy)</span>
        <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> jobjCharp <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetStringUTFChars</span><span class="token punctuation">(</span>jobj<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">LOGI</span><span class="token punctuation">(</span><span class="token string">&quot;\u53C2\u6570\u56DB \u5F15\u7528\u7C7B\u578BString \u5177\u4F53\u7684\uFF1A%s\\n&quot;</span><span class="token punctuation">,</span> jobjCharp<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u91CA\u653Ejstring</span>
        env<span class="token operator">-&gt;</span><span class="token function">ReleaseStringUTFChars</span><span class="token punctuation">(</span>jobj<span class="token punctuation">,</span> jobjCharp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5BF9\u8C61\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u8C61\u64CD\u4F5C" aria-hidden="true">#</a> \u5BF9\u8C61\u64CD\u4F5C</h4><div class="language-cpp ext-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">// jobject student == Student</span>
<span class="token comment">// jstring str  == String</span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span>
JNIEXPORT <span class="token keyword">void</span> JNICALL
<span class="token function">Java_com_derry_as_1jni_1project_MainActivity_putObject</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span>
                                                       jobject thiz<span class="token punctuation">,</span>
                                                       jobject student<span class="token punctuation">,</span>
                                                       jstring str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> strChar <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetStringUTFChars</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">LOGI</span><span class="token punctuation">(</span><span class="token string">&quot;strChar\uFF1A%s\\n&quot;</span><span class="token punctuation">,</span> strChar<span class="token punctuation">)</span><span class="token punctuation">;</span>
    env<span class="token operator">-&gt;</span><span class="token function">ReleaseStringUTFChars</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> strChar<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// --------------</span>
    <span class="token comment">// 1.\u5BFB\u627E\u7C7B Student</span>
    <span class="token comment">// jclass studentClass = env-&gt;FindClass(&quot;com/derry/as_jni_project/Student&quot;); // \u7B2C\u4E00\u79CD</span>
    jclass studentClass <span class="token operator">=</span>  env<span class="token operator">-&gt;</span><span class="token function">GetObjectClass</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u7B2C\u4E8C\u79CD</span>

    <span class="token comment">// 2.Student\u7C7B\u91CC\u9762\u7684\u51FD\u6570\u89C4\u5219  \u7B7E\u540D</span>
    jmethodID setName <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetMethodID</span><span class="token punctuation">(</span>studentClass<span class="token punctuation">,</span> <span class="token string">&quot;setName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(Ljava/lang/String;)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    jmethodID getName <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetMethodID</span><span class="token punctuation">(</span>studentClass<span class="token punctuation">,</span> <span class="token string">&quot;getName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;()Ljava/lang/String;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    jmethodID showInfo <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetStaticMethodID</span><span class="token punctuation">(</span>studentClass<span class="token punctuation">,</span> <span class="token string">&quot;showInfo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(Ljava/lang/String;)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3.\u8C03\u7528 setName</span>
    jstring value <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">NewStringUTF</span><span class="token punctuation">(</span><span class="token string">&quot;AAAA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    env<span class="token operator">-&gt;</span><span class="token function">CallVoidMethod</span><span class="token punctuation">(</span>student<span class="token punctuation">,</span> setName<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 4.\u8C03\u7528 getName</span>
    jstring getNameResult <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>jstring<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>env<span class="token operator">-&gt;</span><span class="token function">CallObjectMethod</span><span class="token punctuation">(</span>student<span class="token punctuation">,</span> getName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> getNameValue <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetStringUTFChars</span><span class="token punctuation">(</span>getNameResult<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">LOGE</span><span class="token punctuation">(</span><span class="token string">&quot;\u8C03\u7528\u5230getName\u65B9\u6CD5\uFF0C\u503C\u662F:%s\\n&quot;</span><span class="token punctuation">,</span> getNameValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 5.\u8C03\u7528\u9759\u6001showInfo</span>
    jstring  jstringValue <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">NewStringUTF</span><span class="token punctuation">(</span><span class="token string">&quot;\u9759\u6001\u65B9\u6CD5\u4F60\u597D\uFF0C\u6211\u662FC++&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    env<span class="token operator">-&gt;</span><span class="token function">CallStaticVoidMethod</span><span class="token punctuation">(</span>studentClass<span class="token punctuation">,</span> showInfo<span class="token punctuation">,</span> jstringValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5BF9\u8C61\u64CD\u4F5C\u8FDB\u9636" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u8C61\u64CD\u4F5C\u8FDB\u9636" aria-hidden="true">#</a> \u5BF9\u8C61\u64CD\u4F5C\u8FDB\u9636</h4><div class="language-cpp ext-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span>
JNIEXPORT <span class="token keyword">void</span> JNICALL
<span class="token function">Java_com_derry_as_1jni_1project_MainActivity_insertObject</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jobject thiz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1.\u901A\u8FC7\u5305\u540D+\u7C7B\u540D\u7684\u65B9\u5F0F \u62FF\u5230 Student class  \u51ED\u7A7A\u62FFclass</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>studentstr <span class="token operator">=</span> <span class="token string">&quot;com/derry/as_jni_project/Student&quot;</span><span class="token punctuation">;</span>
    jclass studentClass <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">FindClass</span><span class="token punctuation">(</span>studentstr<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2.\u901A\u8FC7student\u7684class  \u5B9E\u4F8B\u5316\u6B64Student\u5BF9\u8C61   C++ new Student</span>
    jobject studentObj <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">AllocObject</span><span class="token punctuation">(</span>studentClass<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// AllocObject \u53EA\u5B9E\u4F8B\u5316\u5BF9\u8C61\uFF0C\u4E0D\u4F1A\u8C03\u7528\u5BF9\u8C61\u7684\u6784\u9020\u51FD\u6570</span>

    <span class="token comment">// \u65B9\u6CD5\u7B7E\u540D\u7684\u89C4\u5219</span>
    jmethodID setName <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetMethodID</span><span class="token punctuation">(</span>studentClass<span class="token punctuation">,</span> <span class="token string">&quot;setName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(Ljava/lang/String;)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    jmethodID setAge <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetMethodID</span><span class="token punctuation">(</span>studentClass<span class="token punctuation">,</span> <span class="token string">&quot;setAge&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(I)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// \u8C03\u7528\u65B9\u6CD5</span>
    jstring strValue <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">NewStringUTF</span><span class="token punctuation">(</span><span class="token string">&quot;Derry&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    env<span class="token operator">-&gt;</span><span class="token function">CallVoidMethod</span><span class="token punctuation">(</span>studentObj<span class="token punctuation">,</span> setName<span class="token punctuation">,</span> strValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    env<span class="token operator">-&gt;</span><span class="token function">CallVoidMethod</span><span class="token punctuation">(</span>studentObj<span class="token punctuation">,</span> setAge<span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token comment">// env-&gt;NewObject() // NewObject \u5B9E\u4F8B\u5316\u5BF9\u8C61\uFF0C\u4F1A\u8C03\u7528\u5BF9\u8C61\u7684\u6784\u9020\u51FD\u6570</span>


    <span class="token comment">// ====================  \u4E0B\u9762\u662F Person\u5BF9\u8C61  \u8C03\u7528person\u5BF9\u8C61\u7684  setStudent \u51FD\u6570\u7B49</span>

    <span class="token comment">// 4.\u901A\u8FC7\u5305\u540D+\u7C7B\u540D\u7684\u65B9\u5F0F \u62FF\u5230 Student class  \u51ED\u7A7A\u62FFclass</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>personstr <span class="token operator">=</span> <span class="token string">&quot;com/derry/as_jni_project/Person&quot;</span><span class="token punctuation">;</span>
    jclass personClass <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">FindClass</span><span class="token punctuation">(</span>personstr<span class="token punctuation">)</span><span class="token punctuation">;</span>

    jobject personObj <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">AllocObject</span><span class="token punctuation">(</span>personClass<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// AllocObject \u53EA\u5B9E\u4F8B\u5316\u5BF9\u8C61\uFF0C\u4E0D\u4F1A\u8C03\u7528\u5BF9\u8C61\u7684\u6784\u9020\u51FD\u6570</span>

    <span class="token comment">// setStudent \u6B64\u51FD\u6570\u7684 \u7B7E\u540D \u89C4\u5219</span>
    jmethodID setStudent <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetMethodID</span><span class="token punctuation">(</span>personClass<span class="token punctuation">,</span> <span class="token string">&quot;setStudent&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;(Lcom/derry/as_jni_project/Student;)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    env<span class="token operator">-&gt;</span><span class="token function">CallVoidMethod</span><span class="token punctuation">(</span>personObj<span class="token punctuation">,</span> setStudent<span class="token punctuation">,</span> studentObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5168\u5C40\u5F15\u7528-\u5C40\u90E8\u5F15\u7528\u7406\u89E3" tabindex="-1"><a class="header-anchor" href="#\u5168\u5C40\u5F15\u7528-\u5C40\u90E8\u5F15\u7528\u7406\u89E3" aria-hidden="true">#</a> \u5168\u5C40\u5F15\u7528 \u5C40\u90E8\u5F15\u7528\u7406\u89E3</h4><div class="language-cpp ext-cpp line-numbers-mode"><pre class="language-cpp"><code>jclass dogClass<span class="token punctuation">;</span> <span class="token comment">// \u4F60\u4EE5\u4E3A\u8FD9\u4E2A\u662F\u5168\u5C40\u5F15\u7528\uFF0C\u5B9E\u9645\u4E0A\u4ED6\u8FD8\u662F\u5C40\u90E8\u5F15\u7528</span>

<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span>
JNIEXPORT <span class="token keyword">void</span> JNICALL
<span class="token function">Java_com_derry_as_1jni_1project_MainActivity_testQuote</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jobject thiz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> dogClass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/*const char * dogStr = &quot;com/derry/as_jni_project/Dog&quot;;
        dogClass = env-&gt;FindClass(dogStr);*/</span>

        <span class="token comment">// \u5347\u7EA7\u5168\u5C40\u5F15\u7528\uFF1A JNI\u51FD\u6570\u7ED3\u675F\u4E5F\u4E0D\u91CA\u653E\uFF0C\u53CD\u6B63\u5C31\u662F\u4E0D\u91CA\u653E\uFF0C\u5FC5\u987B\u624B\u52A8\u91CA\u653E   ----- \u76F8\u5F53\u4E8E\uFF1A C++ \u5BF9\u8C61 new\u3001\u624B\u52A8delete</span>
        <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> dogStr <span class="token operator">=</span> <span class="token string">&quot;com/derry/as_jni_project/Dog&quot;</span><span class="token punctuation">;</span>
        jclass temp <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">FindClass</span><span class="token punctuation">(</span>dogStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dogClass <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>jclass<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>env<span class="token operator">-&gt;</span><span class="token function">NewGlobalRef</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u63D0\u5347\u5168\u5C40\u5F15\u7528</span>
        <span class="token comment">// \u8BB0\u4F4F\uFF1A\u7528\u5B8C\u4E86\uFF0C\u5982\u679C\u4E0D\u7528\u4E86\uFF0C\u9A6C\u4E0A\u91CA\u653E\uFF0CC C++ \u5DE5\u7A0B\u5E08\u7684\u8D5E\u7F8E</span>
        env<span class="token operator">-&gt;</span><span class="token function">DeleteLocalRef</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// &lt;init&gt; V  \u662F\u4E0D\u4F1A\u53D8\u7684</span>

    <span class="token comment">// \u6784\u9020\u51FD\u6570\u4E00</span>
    jmethodID init <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetMethodID</span><span class="token punctuation">(</span>dogClass<span class="token punctuation">,</span> <span class="token string">&quot;&lt;init&gt;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;()V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    jobject dog <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">NewObject</span><span class="token punctuation">(</span>dogClass<span class="token punctuation">,</span> init<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// \u6784\u9020\u51FD\u65702</span>
    init <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetMethodID</span><span class="token punctuation">(</span>dogClass<span class="token punctuation">,</span> <span class="token string">&quot;&lt;init&gt;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(I)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dog <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">NewObject</span><span class="token punctuation">(</span>dogClass<span class="token punctuation">,</span> init<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token comment">// \u6784\u9020\u51FD\u65703</span>
    init <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetMethodID</span><span class="token punctuation">(</span>dogClass<span class="token punctuation">,</span> <span class="token string">&quot;&lt;init&gt;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(II)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dog <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">NewObject</span><span class="token punctuation">(</span>dogClass<span class="token punctuation">,</span> init<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// \u6784\u9020\u51FD\u65704</span>
    init <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">GetMethodID</span><span class="token punctuation">(</span>dogClass<span class="token punctuation">,</span> <span class="token string">&quot;&lt;init&gt;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(III)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dog <span class="token operator">=</span> env<span class="token operator">-&gt;</span><span class="token function">NewObject</span><span class="token punctuation">(</span>dogClass<span class="token punctuation">,</span> init<span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    env<span class="token operator">-&gt;</span><span class="token function">DeleteLocalRef</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u91CA\u653E</span>
<span class="token punctuation">}</span>

<span class="token comment">// JNI\u51FD\u6570\u7ED3\u675F\uFF0C\u4F1A\u91CA\u653E\u5C40\u90E8\u5F15\u7528   dogClass\u867D\u7136\u88AB\u91CA\u653E\uFF0C\u4F46\u662F\u8FD8\u4E0D\u7B49\u4E8ENULL\uFF0C\u53EA\u662F\u4E00\u4E2A\u60AC\u7A7A\u6307\u9488\u800C\u5DF2\uFF0C\u6240\u4EE5\u7B2C\u4E8C\u6B21\u8FDB\u4E0D\u6765IF\uFF0C\u4F1A\u5954\u6E83</span>

<span class="token comment">// \u624B\u52A8\u91CA\u653E\u5168\u5C40\u5F15\u7528</span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span>
JNIEXPORT <span class="token keyword">void</span> JNICALL
<span class="token function">Java_com_derry_as_1jni_1project_MainActivity_delQuote</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jobject thiz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>dogClass <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">LOGE</span><span class="token punctuation">(</span><span class="token string">&quot;\u5168\u5C40\u5F15\u7528\u91CA\u653E\u5B8C\u6BD5\uFF0C\u4E0A\u9762\u7684\u6309\u94AE\u5DF2\u7ECF\u5931\u53BB\u5168\u5C40\u5F15\u7528\uFF0C\u518D\u6B21\u70B9\u51FB\u4F1A\u62A5\u9519&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       env<span class="token operator">-&gt;</span><span class="token function">DeleteGlobalRef</span><span class="token punctuation">(</span>dogClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
       dogClass <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">// \u6700\u597D\u7ED9\u4E00\u4E2ANULL\uFF0C\u6307\u5411NULL\u7684\u5730\u5740\uFF0C\u4E0D\u8981\u53BB\u6210\u4E3A\u60AC\u7A7A\u6307\u9488</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="extern" tabindex="-1"><a class="header-anchor" href="#extern" aria-hidden="true">#</a> extern</h4><div class="language-cpp ext-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token comment">// \u65E5\u5FD7\u8F93\u51FA</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;android/log.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TAG</span> <span class="token string">&quot;JNISTUDY&quot;</span></span>
<span class="token comment">// __VA_ARGS__ \u4EE3\u8868 ...\u7684\u53EF\u53D8\u53C2\u6570</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">LOGD</span><span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token function">__android_log_print</span><span class="token punctuation">(</span>ANDROID_LOG_DEBUG<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span>  __VA_ARGS__<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">LOGE</span><span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token function">__android_log_print</span><span class="token punctuation">(</span>ANDROID_LOG_ERROR<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span>  __VA_ARGS__<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">LOGI</span><span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token function">__android_log_print</span><span class="token punctuation">(</span>ANDROID_LOG_INFO<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span>  __VA_ARGS__<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span>

<span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span> <span class="token comment">// \u5B9E\u73B0</span>

<span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// \u5B9E\u73B0</span>
    <span class="token comment">// 5000\u884C\u4EE3\u7801</span>
    <span class="token comment">// ...</span>

    <span class="token function">LOGI</span><span class="token punctuation">(</span><span class="token string">&quot;show run age:%d\\n&quot;</span><span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-cpp ext-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">// \u975E\u5E38\u65B9\u4FBF\uFF0C\u53EF\u4EE5\u4F7F\u7528\u4E86</span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span> <span class="token comment">// \u58F0\u660Eage</span>
<span class="token keyword">extern</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u58F0\u660Eshow\u51FD\u6570</span>

<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span>
JNIEXPORT <span class="token keyword">void</span> JNICALL
<span class="token function">Java_com_multi_jnistudy_MainActivity_textExternal</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jobject thiz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,53),o=[p];function c(i,l){return s(),a("div",null,o)}const d=n(e,[["render",c],["__file","Jni-base.html.vue"]]);export{d as default};
